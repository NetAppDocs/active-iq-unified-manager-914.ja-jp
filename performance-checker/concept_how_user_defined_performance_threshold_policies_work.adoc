---
permalink: performance-checker/concept_how_user_defined_performance_threshold_policies_work.html 
sidebar: sidebar 
keywords: user-defined, performance, threshold, policies, work 
summary: ストレージオブジェクト（アグリゲートやボリュームなど）に対してパフォーマンスしきい値ポリシーを設定して、クラスタでパフォーマンスの問題が発生していることを通知するイベントをストレージ管理者に送信できるようにします。 
---
= ユーザ定義のパフォーマンスしきい値ポリシーの仕組み
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ストレージオブジェクト（アグリゲートやボリュームなど）に対してパフォーマンスしきい値ポリシーを設定して、クラスタでパフォーマンスの問題が発生していることを通知するイベントをストレージ管理者に送信できるようにします。

ストレージオブジェクトのパフォーマンスしきい値ポリシーを作成するには、次の手順を実行します。

* ストレージオブジェクトの選択
* オブジェクトに関連付けられているパフォーマンスカウンタの選択
* 警告および重大な状況とみなされるパフォーマンスカウンタの上限値を指定する
* カウンタが上限を超えなければならない期間を指定する


たとえば、ボリュームのIOPSが10分間連続で1秒あたり750件の処理数を超えたときに重大イベントの通知を受け取るように、ボリュームに対してパフォーマンスしきい値ポリシーを設定できます。同じしきい値ポリシーで、IOPSが10分間にわたって1秒あたり500件の処理数を超えた場合に警告イベントを送信するように指定することもできます。

[NOTE]
====
現在のリリースでは、カウンタの値が設定値を超えたときにイベントを送信するしきい値を設定できます。カウンタの値が設定値を下回ったときにイベントを送信するしきい値は設定できません。

====
次のカウンタグラフの例では、1：00に警告しきい値（黄色のアイコン）に違反し、12：10、12：30、1：10に重大しきい値（赤のアイコン）に違反しています。

image::../media/opm2_threshold_breach.gif[カウンタグラフの例を示すUIのスクリーンショット。]

しきい値の違反は、指定した期間継続的に発生する必要があります。何らかの理由でしきい値が制限値を下回った場合は、その後の違反が新しい期間の開始とみなされます。

一部のクラスタオブジェクトとパフォーマンスカウンタでは、イベントが生成される前に2つのパフォーマンスカウンタが最大値を超えるようにする組み合わせしきい値ポリシーを作成できます。たとえば、次の条件を使用してしきい値ポリシーを作成できます。

|===
| クラスタオブジェクト | パフォーマンスカウンタ | 警告しきい値 | 重大のしきい値 | 期間 


 a| 
ボリューム
 a| 
レイテンシ
 a| 
10ミリ秒
 a| 
20ミリ秒
 a| 
15分



 a| 
アグリゲート
 a| 
利用率
 a| 
65%
 a| 
85%
 a| 

|===
2つのクラスタオブジェクトを使用するしきい値ポリシーでは、両方の条件に違反した場合にのみイベントが生成されます。たとえば、表に定義されているしきい値ポリシーを使用すると、次のようになります。

|===
| ボリュームレイテンシの平均 | アグリゲートのディスク利用率 | そしたら...。 


 a| 
15ミリ秒
 a| 
50%
 a| 
イベントは報告されません。



 a| 
15ミリ秒
 a| 
75%
 a| 
警告イベントが報告されます。



 a| 
25ミリ秒
 a| 
75%
 a| 
警告イベントが報告されます。



 a| 
25ミリ秒
 a| 
90%
 a| 
重大イベントが報告されます。

|===