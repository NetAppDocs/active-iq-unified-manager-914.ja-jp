---
permalink: storage-mgmt/concept_volume_behavior_during_switchover_and_switchback.html 
sidebar: sidebar 
keywords: volume, behavior, switchover, switchback 
summary: スイッチオーバーまたはスイッチバックをトリガーするイベントが発生すると、ディザスタリカバリグループ内の一方のクラスタからもう一方のクラスタにアクティブなボリュームが移動されます。クライアントにデータを提供していたアクティブなクラスタ上のボリュームは停止され、もう一方のクラスタ上のボリュームがアクティブ化されてデータの提供が開始されます。Unified Managerは、実行中のアクティブなボリュームのみを監視します。 
---
= スイッチオーバーおよびスイッチバックの発生時のボリュームの動作
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
スイッチオーバーまたはスイッチバックをトリガーするイベントが発生すると、ディザスタリカバリグループ内の一方のクラスタからもう一方のクラスタにアクティブなボリュームが移動されます。クライアントにデータを提供していたアクティブなクラスタ上のボリュームは停止され、もう一方のクラスタ上のボリュームがアクティブ化されてデータの提供が開始されます。Unified Managerは、実行中のアクティブなボリュームのみを監視します。

ボリュームはクラスタ間で移動されるため、両方のクラスタを監視することを推奨します。MetroCluster構成の両方のクラスタを単一のインスタンスで監視できますが、2つのサイト間の距離によっては、両方のクラスタを監視するためにUnified Managerインスタンスを2つ使用しなければならない場合があります。次の図は、Unified Managerの単一インスタンスを示しています。

image::../media/opm_mcc_switchover.gif[Unified Managerの単一インスタンスを示すUIのスクリーンショット。]

名前に「p」が付いたボリュームはプライマリボリュームで、「b」が付いたボリュームはSnapMirrorによって作成されたミラーバックアップボリュームです。

通常動作時：

* クラスタ A には、 Vol1p と Vol2p の 2 つのアクティブボリュームがあります。
* クラスタ B には、 Vol3p と Vol4p の 2 つのアクティブボリュームがあります。
* クラスタ A の 2 つのボリュームが非アクティブ： Vol3b と Vol4b
* クラスタ B の 2 つのボリュームが非アクティブ： Vol1b および Vol2b


Unified Managerでは、アクティブなボリュームごとに関連する情報（統計やイベントなど）が収集されます。Vol1pとVol2pの統計はクラスタAで収集され、Vol3pとVol4pの統計はクラスタBで収集されます。

重大な障害が発生してアクティブボリュームがクラスタBからクラスタAにスイッチオーバーされたあと、次の手順を実行します。

* クラスタ A には、 Vol1p 、 Vol2p 、 Vol3b 、 Vol4b の 4 つのアクティブボリュームがあります。
* クラスタ B の 4 つのボリュームが非アクティブ： Vol3p 、 Vol4p 、 Vol1b 、 Vol2b 。


通常運用時と同様に、Unified Managerによってアクティブボリュームのそれぞれに関する情報が収集されます。ただし、この場合はVol1pとVol2pの統計がクラスタAで収集され、Vol3bとVol4bの統計もクラスタAで収集されます。

Vol3pとVol3bは異なるクラスタにあるため、同じボリュームではありません。Unified ManagerのVol3pの情報がVol3bと同じではありません。

* クラスタAへのスイッチオーバー中は、Vol3pの統計とイベントは表示されません。
* スイッチオーバーの最初の時点では、Vol3bは履歴情報のない新しいボリュームのように見えます。


クラスタBが修復されてスイッチバックが実行されると、クラスタBでVol3pが再びアクティブになり、スイッチオーバー中の期間の統計が一致しない状態になります。Vol3bは、別のスイッチオーバーが発生するまでクラスタAからは表示されません。

image::../media/opm_mcc_volumes.gif[スイッチオーバー時のボリュームの動作を示すUIのスクリーンショット。]

[NOTE]
====
* スイッチバック後にクラスタ A の Vol3b など、非アクティブな MetroCluster ボリュームは「 This volume was deleted` 」というメッセージで示されます。このボリュームは実際には削除されませんが、アクティブなボリュームではないためUnified Managerで現在監視されていません。
* 1つのUnified ManagerでMetroCluster構成の両方のクラスタを監視している場合、ボリューム検索ではその時点でアクティブなボリュームに関する情報が返されます。たとえば、スイッチオーバーが発生し、クラスタAでvol3がアクティブになった場合、「vol3」を検索すると、クラスタAのVol3bの統計とイベントが返されます。


====